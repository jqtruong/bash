#!/bin/bash

_is_func() {
    declare -f $1
} >/dev/null

_defunc() {
    if [[ $DEBUG ]]
    then cat <<EOF

------------------------- CALLING --------------------------
$func
------------------------------------------------------------

EOF
    fi
}

_log(){
    echo "[LOG: $1]"
} >&2

_process() {
    while [[ $argc -gt 0 ]]
    do
        if _is_func ${argv[0]}
        then
            _shift_argv
            func=$arg
            echo >&2 "[PROCESS: CALLING $func WITH ${argv[@]}]"
            $func ${argv[@]}
        else
            echo >&2 "[ERROR: func ${argv[0]} does not exist]"
            break
        fi
    done
}

_shift_argv() {
    local n=${1-1}

    arg="${argv[@]:0:n}"
    argv=("${argv[@]:n}")
    argc=$((argc - n))
}
